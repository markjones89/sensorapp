(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{215:function(t,r,n){"use strict";n.r(r);var e=n(1),o=n.n(e),a=n(4),i=n(2),s=n(13),c=n(6);n(41);function l(t,r,n,e,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?r(c):Promise.resolve(c).then(e,o)}function d(t){return function(){var r=this,n=arguments;return new Promise((function(e,o){var a=t.apply(r,n);function i(t){l(a,e,o,i,s,"next",t)}function s(t){l(a,e,o,i,s,"throw",t)}i(void 0)}))}}var u="/api/locations",f="/api/floors",p={props:["bldg_id"],components:{BuildingSvg:s.a,CaretIcon:c.a,CaretLeftIcon:c.b,FilterDropdown:i.d,Loader:i.e},data:function(){return{buildings:[],building:null,bldgFilter:null,loaded:!1,showPageOpts:!1,showEmbed:!1,showFilter:!1,floors:[],floorsReverse:[]}},computed:{buildingFilters:function(){return this.buildings.map((function(t){return{value:t.hid,label:t.name}}))}},methods:{backTo:function(){this.$router.back()},getBuildings:function(){var t=this;return d(o.a.mark((function r(){var n,e,i;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=a.a.getUserCompany()){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,axios.get(u,{params:{cid:n.hid,lob:!0}});case 5:e=r.sent,i=e.data,t.buildings=i,t.bldg_id?t.building=i.find((function(r){return r.hid===t.bldg_id})):t.building=i[0],t.bldgFilter=t.building.name,t.getFloors(t.building.hid,(function(){t.loaded=!0}));case 11:case"end":return r.stop()}}),r)})))()},getFloors:function(t,r){var n=this;return d(o.a.mark((function e(){var a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get(f,{params:{bid:t}});case 2:return a=e.sent,(i=a.data).forEach((function(t){t.occupancy_live=Math.floor(Math.random()*t.occupancy_limit+1)})),n.floors=i.sort((function(t,r){return t.floor_no>r.floor_no?1:t.floor_no<r.floor_no?-1:0})),n.floorsReverse=i.sort((function(t,r){return t.floor_no>r.floor_no?-1:t.floor_no<r.floor_no?1:0})),e.abrupt("return",r&&r());case 8:case"end":return e.stop()}}),e)})))()},getLiveColor:function(t,r){var n=t/r*100;return{green:n<50,yellow:n>=50,orange:n>=90}},filterSelect:function(t){this.showFilter=!1,this.building=this.buildings.find((function(r){return r.hid===t})),this.bldgFilter=this.building.name,this.getFloors(this.building.hid)},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t},floorClick:function(t){this.toLive(t.hid)},toLive:function(t){this.$router.push({name:"live",query:{bid:this.building.hid,fid:t}})}},mounted:function(){this.getBuildings()}},g=(n(98),n(3)),v=Object(g.a)(p,(function(){var t=this,r=t.$createElement,n=t._self._c||r;return n("div",{staticClass:"content"},[t.loaded&&t.building?[n("div",{staticClass:"graph-header"},[n("div",{staticClass:"page-back"},[n("div",{staticClass:"back-button",on:{click:t.backTo}},[n("button",{staticClass:"btn btn-primary btn-small"},[n("caret-left-icon")],1),t._v("\n                    Back\n                ")])]),t._v(" "),n("div",{staticClass:"graph-filters"},[n("span",{staticClass:"graph-filter",on:{click:function(r){t.showFilter=!t.showFilter}}},[t._v("\n                    "+t._s(t.bldgFilter?t.bldgFilter:"Select Building")+"\n                    "),n("span",{staticClass:"caret"},[n("caret-icon")],1),t._v(" "),n("filter-dropdown",{attrs:{filters:t.buildingFilters,show:t.showFilter},on:{onSelect:t.filterSelect}})],1)]),t._v(" "),n("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(r){t.showPageOpts=!t.showPageOpts}}},[n("span",{staticClass:"dot"}),t._v(" "),n("span",{staticClass:"dot"}),t._v(" "),n("span",{staticClass:"dot"})]),t._v(" "),n("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?n("div",{staticClass:"page-opt-panel"},[n("ul",[n("li",[n("a",{on:{click:function(r){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),n("div",{staticClass:"graph-content"},[n("div",{staticClass:"chart-header"},[n("span",{staticClass:"chart-title"},[t._v(t._s(t.building.name)+" Occupancy")])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col svg-wrapper"},[n("building-svg",{attrs:{floors:t.floors,clickableFloor:!0},on:{floorClick:t.floorClick}})],1),t._v(" "),n("div",{staticClass:"col info-wrapper"},[n("table",[t._m(0),t._v(" "),n("tbody",t._l(t.floorsReverse,(function(r){return n("tr",{key:r.hid,staticClass:"floor-info"},[n("td",[t._v(t._s(r.ordinal_no+" Floor"))]),t._v(" "),n("td",[n("span",{staticClass:"occ-badge live-badge",class:t.getLiveColor(r.occupancy_live,r.occupancy_limit),on:{click:function(n){return t.toLive(r.hid)}}},[t._v(t._s(r.occupancy_live))])]),t._v(" "),n("td",[n("span",{staticClass:"occ-badge limit-badge orange"},[t._v(t._s(r.occupancy_limit))])])])})),0)])])])])]:t._e(),t._v(" "),n("loader",{attrs:{show:!t.loaded,type:"ripple"}})],2)}),[function(){var t=this.$createElement,r=this._self._c||t;return r("thead",[r("tr",{staticClass:"info-header"},[r("th",{attrs:{width:"100"}}),this._v(" "),r("th",{attrs:{width:"80"}},[this._v("Live")]),this._v(" "),r("th",{attrs:{width:"80"}},[this._v("Limit")])])])}],!1,null,"7d2e4b32",null);r.default=v.exports},24:function(t,r,n){var e=n(99);"string"==typeof e&&(e=[[t.i,e,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(8)(e,o);e.locals&&(t.exports=e.locals)},41:function(t,r,n){"use strict";n.d(r,"a",(function(){return o}));var e=n(0);function o(t,r){var n=e.y(t),o=e.l(r),a=10,i=10,s=40,c=e.B().nodeSize([16,150]),l=e.o().x((function(t){return t.y})).y((function(t){return t.x})),d=n.append("svg").attr("viewBox",[-s,-a,900,16]).style("font-size","12px").style("user-select","none"),u=d.append("g").attr("fill","none").attr("stroke","#3DCFA3").attr("stroke-opacity",.4).attr("stroke-width",1.5),f=d.append("g").attr("cursor","pointer").attr("pointer-events","all");return o.x0=75,o.y0=0,o.descendants().forEach((function(t,r){t.id=r,t._children=t.children,t.depth&&7!==t.data.name.length&&(t.children=null)})),function t(r){var n=e.i&&e.i.altKey?2500:250,p=o.descendants().reverse(),g=o.links();c(o);var v=o,h=o;o.eachBefore((function(t){t.x<v.x&&(v=t),t.x>h.x&&(h=t)}));var b=h.x-v.x+a+i,w=d.transition().duration(n).attr("viewBox",[-s,v.x-a,900,b]).tween("resize",window.ResizeObserver?null:function(){return function(){return d.dispatch("toggle")}}),_=f.selectAll("g").data(p,(function(t){return t.id})),x=_.enter().append("g").attr("data-id",(function(t){return t.id})).attr("transform",(function(t){return"translate(".concat(r.y0,",").concat(r.x0,")")})).attr("fill-opacity",0).attr("stroke-opacity",0).on("click",(function(r){r.children=r.children?null:r._children,t(r)}));x.append("circle").attr("r",2.5).attr("fill",(function(t){return t._children,"#3DCFA3"})).attr("stroke-width",10),x.append("text").attr("dy","0.31em").attr("x",(function(t){return t._children?-6:6})).attr("text-anchor",(function(t){return t._children?"end":"start"})).attr("fill","#fff").text((function(t){return t.data.name})).clone(!0).lower().attr("stroke-linejoin","round").attr("stroke-width",3).attr("stroke","#2B2B2B"),_.merge(x).transition(w).attr("transform",(function(t){return"translate(".concat(t.y,",").concat(t.x,")")})).attr("fill-opacity",1).attr("stroke-opacity",1),_.exit().transition(w).remove().attr("transform",(function(t){return"translate(".concat(r.y,",").concat(r.x,")")})).attr("fill-opacity",0).attr("stroke-opacity",0);var m=u.selectAll("path").data(g,(function(t){return t.target.id})),y=m.enter().append("path").attr("d",(function(t){var n={x:r.x0,y:r.y0};return l({source:n,target:n})}));m.merge(y).transition(w).attr("d",(function(t){var r=t.target._children&&t.target._children.length>0,n=f.select('[data-id="'.concat(t.target.id,'"]')).node().getBBox(),e={x:t.target.x,y:t.target.y-n.width};return l(r?{source:t.source,target:e}:{source:t.source,target:t.target})})),m.exit().transition(w).remove().attr("d",(function(t){var n={x:r.x,y:r.y};return l({source:n,target:n})})),o.eachBefore((function(t){t.x0=t.x,t.y0=t.y}))}(o),d.node()}},98:function(t,r,n){"use strict";var e=n(24);n.n(e).a},99:function(t,r,n){(t.exports=n(7)(!1)).push([t.i,".svg-wrapper[data-v-7d2e4b32]{text-align:right}.svg-wrapper .building-svg[data-v-7d2e4b32]{padding:0 36px}.info-wrapper[data-v-7d2e4b32]{padding:150px 36px 0}.info-wrapper table[data-v-7d2e4b32]{border-collapse:collapse}.info-wrapper .info-header th[data-v-7d2e4b32]{font-weight:400}.info-wrapper .floor-info[data-v-7d2e4b32]{line-height:26px;border-bottom:1px solid rgba(255,255,225,.1)}.info-wrapper .floor-info[data-v-7d2e4b32]:last-child{border-bottom:none}.info-wrapper .floor-info td[data-v-7d2e4b32]{padding:10px 0}.info-wrapper .floor-info td[data-v-7d2e4b32]:first-child{text-align:left}.info-wrapper .floor-info .occ-badge[data-v-7d2e4b32]{display:inline-block;padding:0 16px;border-radius:4px}.info-wrapper .floor-info .occ-badge.live-badge[data-v-7d2e4b32]{cursor:pointer;transition:background-color .24s}.info-wrapper .floor-info .occ-badge.green[data-v-7d2e4b32]{background-color:#01fe01}.info-wrapper .floor-info .occ-badge.green[data-v-7d2e4b32]:hover{background-color:#01cb01}.info-wrapper .floor-info .occ-badge.yellow[data-v-7d2e4b32]{background-color:#ff8600}.info-wrapper .floor-info .occ-badge.yellow[data-v-7d2e4b32]:hover{background-color:#cc6b00}.info-wrapper .floor-info .occ-badge.orange[data-v-7d2e4b32]{background-color:#ed0003}.info-wrapper .floor-info .occ-badge.orange[data-v-7d2e4b32]:hover{background-color:#ba0002}",""])}}]);