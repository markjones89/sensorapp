(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{20:function(t,n,r){var e=r(95);"string"==typeof e&&(e=[[t.i,e,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(8)(e,a);e.locals&&(t.exports=e.locals)},211:function(t,n,r){"use strict";r.r(n);var e=r(1),a=r.n(e),o=r(4),i=r(2),s=r(12),l=r(6);r(35);function c(t,n,r,e,a,o,i){try{var s=t[o](i),l=s.value}catch(t){return void r(t)}s.done?n(l):Promise.resolve(l).then(e,a)}function d(t){return function(){var n=this,r=arguments;return new Promise((function(e,a){var o=t.apply(n,r);function i(t){c(o,e,a,i,s,"next",t)}function s(t){c(o,e,a,i,s,"throw",t)}i(void 0)}))}}var u="/api/locations",f="/api/floors",p={props:["bldg_id"],components:{BuildingSvg:s.a,CaretIcon:l.a,CaretLeftIcon:l.b,FilterDropdown:i.d,Loader:i.e},data:function(){return{buildings:[],building:null,bldgFilter:null,loaded:!1,showPageOpts:!1,showEmbed:!1,showFilter:!1,floors:[],floorsReverse:[]}},computed:{buildingFilters:function(){return this.buildings.map((function(t){return{value:t.hid,label:t.name}}))}},methods:{backTo:function(){this.$router.back()},getBuildings:function(){var t=this;return d(a.a.mark((function n(){var r,e,i;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=o.a.getUserCompany()){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,axios.get(u,{params:{cid:r.hid,lob:!0}});case 5:e=n.sent,i=e.data,t.buildings=i,t.bldg_id?t.building=i.find((function(n){return n.hid===t.bldg_id})):t.building=i[0],t.bldgFilter=t.building.name,t.getFloors(t.building.hid,(function(){t.loaded=!0}));case 11:case"end":return n.stop()}}),n)})))()},getFloors:function(t,n){var r=this;return d(a.a.mark((function e(){var o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get(f,{params:{bid:t}});case 2:return o=e.sent,(i=o.data).forEach((function(t){t.occupancy_live=Math.floor(Math.random()*t.occupancy_limit+1)})),r.floors=i.sort((function(t,n){return t.floor_no>n.floor_no?1:t.floor_no<n.floor_no?-1:0})),r.floorsReverse=i.sort((function(t,n){return t.floor_no>n.floor_no?-1:t.floor_no<n.floor_no?1:0})),e.abrupt("return",n&&n());case 8:case"end":return e.stop()}}),e)})))()},getLiveColor:function(t,n){var r=t/n*100;return{green:r<50,yellow:r>=50,orange:r>=90}},filterSelect:function(t){this.showFilter=!1,this.building=this.buildings.find((function(n){return n.hid===t})),this.bldgFilter=this.building.name,this.getFloors(this.building.hid)},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t}},mounted:function(){this.getBuildings()}},g=(r(94),r(3)),h=Object(g.a)(p,(function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",{staticClass:"content"},[t.loaded&&t.building?[r("div",{staticClass:"graph-header"},[r("div",{staticClass:"page-back"},[r("div",{staticClass:"back-button",on:{click:t.backTo}},[r("button",{staticClass:"btn btn-primary btn-small"},[r("caret-left-icon")],1),t._v("\n                    Back\n                ")])]),t._v(" "),r("div",{staticClass:"graph-filters"},[r("span",{staticClass:"graph-filter",on:{click:function(n){t.showFilter=!t.showFilter}}},[t._v("\n                    "+t._s(t.bldgFilter?t.bldgFilter:"Select Building")+"\n                    "),r("span",{staticClass:"caret"},[r("caret-icon")],1),t._v(" "),r("filter-dropdown",{attrs:{filters:t.buildingFilters,show:t.showFilter},on:{onSelect:t.filterSelect}})],1)]),t._v(" "),r("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(n){t.showPageOpts=!t.showPageOpts}}},[r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"})]),t._v(" "),r("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?r("div",{staticClass:"page-opt-panel"},[r("ul",[r("li",[r("a",{on:{click:function(n){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),r("div",{staticClass:"graph-content"},[r("div",{staticClass:"chart-header"},[r("span",{staticClass:"chart-title"},[t._v(t._s(t.building.name)+" Occupancy")])]),t._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col svg-wrapper"},[r("building-svg",{attrs:{floors:t.floors}})],1),t._v(" "),r("div",{staticClass:"col info-wrapper"},[r("table",[t._m(0),t._v(" "),r("tbody",t._l(t.floorsReverse,(function(n){return r("tr",{key:n.hid,staticClass:"floor-info"},[r("td",[t._v(t._s(n.ordinal_no+" Floor"))]),t._v(" "),r("td",[r("span",{staticClass:"occ-badge",class:t.getLiveColor(n.occupancy_live,n.occupancy_limit)},[t._v(t._s(n.occupancy_live))])]),t._v(" "),r("td",[r("span",{staticClass:"occ-badge orange"},[t._v(t._s(n.occupancy_limit))])])])})),0)])])])])]:t._e(),t._v(" "),r("loader",{attrs:{show:!t.loaded,type:"ripple"}})],2)}),[function(){var t=this.$createElement,n=this._self._c||t;return n("thead",[n("tr",{staticClass:"info-header"},[n("th",{attrs:{width:"100"}}),this._v(" "),n("th",{attrs:{width:"80"}},[this._v("Live")]),this._v(" "),n("th",{attrs:{width:"80"}},[this._v("Limit")])])])}],!1,null,"f7d67994",null);n.default=h.exports},35:function(t,n,r){"use strict";r.d(n,"a",(function(){return a}));var e=r(0);function a(t,n){var r=e.w(t),a=e.k(n),o=10,i=10,s=40,l=e.y().nodeSize([15,150]),c=e.o().x((function(t){return t.y})).y((function(t){return t.x})),d=r.append("svg").attr("viewBox",[-s,-o,900,15]).style("font-size","12px").style("user-select","none"),u=d.append("g").attr("fill","none").attr("stroke","#3DCFA3").attr("stroke-opacity",.4).attr("stroke-width",1.5),f=d.append("g").attr("cursor","pointer").attr("pointer-events","all");return a.x0=75,a.y0=0,a.descendants().forEach((function(t,n){t.id=n,t._children=t.children,t.depth&&7!==t.data.name.length&&(t.children=null)})),function t(n){var r=e.h&&e.h.altKey?2500:250,p=a.descendants().reverse(),g=a.links();l(a);var h=a,v=a;a.eachBefore((function(t){t.x<h.x&&(h=t),t.x>v.x&&(v=t)}));var b=v.x-h.x+o+i,_=d.transition().duration(r).attr("viewBox",[-s,h.x-o,900,b]).tween("resize",window.ResizeObserver?null:function(){return function(){return d.dispatch("toggle")}}),w=f.selectAll("g").data(p,(function(t){return t.id})),x=w.enter().append("g").attr("data-id",(function(t){return t.id})).attr("transform",(function(t){return"translate(".concat(n.y0,",").concat(n.x0,")")})).attr("fill-opacity",0).attr("stroke-opacity",0).on("click",(function(n){n.children=n.children?null:n._children,t(n)}));x.append("circle").attr("r",2.5).attr("fill",(function(t){return t._children,"#3DCFA3"})).attr("stroke-width",10),x.append("text").attr("dy","0.31em").attr("x",(function(t){return t._children?-6:6})).attr("text-anchor",(function(t){return t._children?"end":"start"})).attr("fill","#fff").text((function(t){return t.data.name})).clone(!0).lower().attr("stroke-linejoin","round").attr("stroke-width",3).attr("stroke","#2B2B2B"),w.merge(x).transition(_).attr("transform",(function(t){return"translate(".concat(t.y,",").concat(t.x,")")})).attr("fill-opacity",1).attr("stroke-opacity",1),w.exit().transition(_).remove().attr("transform",(function(t){return"translate(".concat(n.y,",").concat(n.x,")")})).attr("fill-opacity",0).attr("stroke-opacity",0);var m=u.selectAll("path").data(g,(function(t){return t.target.id})),y=m.enter().append("path").attr("d",(function(t){var r={x:n.x0,y:n.y0};return c([r,r])}));m.merge(y).transition(_).attr("d",(function(t){var n=t.target._children&&t.target._children.length>0,r=f.select('[data-id="'.concat(t.target.id,'"]')).node().getBBox(),e={x:t.target.x,y:t.target.y-r.width};return c(n?[t.source,e]:[t.source,t.target])})),m.exit().transition(_).remove().attr("d",(function(t){var r={x:n.x,y:n.y};return c([r,r])})),a.eachBefore((function(t){t.x0=t.x,t.y0=t.y}))}(a),d.node()}},94:function(t,n,r){"use strict";var e=r(20);r.n(e).a},95:function(t,n,r){(t.exports=r(7)(!1)).push([t.i,".svg-wrapper[data-v-f7d67994] {\n  text-align: right;\n}\n.svg-wrapper .building-svg[data-v-f7d67994] {\n  padding: 0 36px;\n}\n.info-wrapper[data-v-f7d67994] {\n  padding: 150px 36px 0;\n}\n.info-wrapper table[data-v-f7d67994] {\n  border-collapse: collapse;\n}\n.info-wrapper .info-header th[data-v-f7d67994] {\n  font-weight: normal;\n}\n.info-wrapper .floor-info[data-v-f7d67994] {\n  line-height: 26px;\n  border-bottom: 1px solid rgba(255, 255, 225, 0.1);\n}\n.info-wrapper .floor-info[data-v-f7d67994]:last-child {\n  border-bottom: none;\n}\n.info-wrapper .floor-info td[data-v-f7d67994] {\n  padding: 10px 0;\n}\n.info-wrapper .floor-info td[data-v-f7d67994]:first-child {\n  text-align: left;\n}\n.info-wrapper .floor-info .occ-badge[data-v-f7d67994] {\n  display: inline-block;\n  padding: 0 16px;\n  border-radius: 4px;\n}\n.info-wrapper .floor-info .occ-badge.green[data-v-f7d67994] {\n  background-color: #3DCFA3;\n}\n.info-wrapper .floor-info .occ-badge.yellow[data-v-f7d67994] {\n  background-color: #F0A718;\n}\n.info-wrapper .floor-info .occ-badge.orange[data-v-f7d67994] {\n  background-color: #FF5A09;\n}",""])}}]);