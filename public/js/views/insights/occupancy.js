(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{18:function(t,n,r){var a=r(91);"string"==typeof a&&(a=[[t.i,a,""]]);var e={hmr:!0,transform:void 0,insertInto:void 0};r(8)(a,e);a.locals&&(t.exports=a.locals)},209:function(t,n,r){"use strict";r.r(n);var a=r(1),e=r.n(a),o=r(4),i=r(2),s=r(6);r(33);function l(t,n,r,a,e,o,i){try{var s=t[o](i),l=s.value}catch(t){return void r(t)}s.done?n(l):Promise.resolve(l).then(a,e)}function c(t){return function(){var n=this,r=arguments;return new Promise((function(a,e){var o=t.apply(n,r);function i(t){l(o,a,e,i,s,"next",t)}function s(t){l(o,a,e,i,s,"throw",t)}i(void 0)}))}}var d="/api/locations",u="/api/floors",f={props:["bldg_id"],components:{BuildingSvg:i.a,CaretIcon:s.a,CaretLeftIcon:s.b,FilterDropdown:i.e,Loader:i.f},data:function(){return{buildings:[],building:null,bldgFilter:null,loaded:!1,showPageOpts:!1,showEmbed:!1,showFilter:!1,floors:[],floorsReverse:[]}},computed:{buildingFilters:function(){return this.buildings.map((function(t){return{value:t.hid,label:t.name}}))}},methods:{backTo:function(){this.$router.back()},getBuildings:function(){var t=this;return c(e.a.mark((function n(){var r,a,i;return e.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=o.a.getUserCompany()){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,axios.get(d,{params:{cid:r.hid,lob:!0}});case 5:a=n.sent,i=a.data,t.buildings=i,t.bldg_id?t.building=i.find((function(n){return n.hid===t.bldg_id})):t.building=i[0],t.bldgFilter=t.building.name,t.getFloors(t.building.hid,(function(){t.loaded=!0}));case 11:case"end":return n.stop()}}),n)})))()},getFloors:function(t,n){var r=this;return c(e.a.mark((function a(){var o,i;return e.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,axios.get(u,{params:{bid:t}});case 2:return o=a.sent,(i=o.data).forEach((function(t){t.occupancy_live=Math.floor(Math.random()*t.occupancy_limit+1)})),r.floors=i.sort((function(t,n){return t.floor_no>n.floor_no?1:t.floor_no<n.floor_no?-1:0})),r.floorsReverse=i.sort((function(t,n){return t.floor_no>n.floor_no?-1:t.floor_no<n.floor_no?1:0})),a.abrupt("return",n&&n());case 8:case"end":return a.stop()}}),a)})))()},getLiveColor:function(t,n){var r=t/n*100;return{green:r<50,yellow:r>=50,orange:r>=90}},filterSelect:function(t){this.showFilter=!1,this.building=this.buildings.find((function(n){return n.hid===t})),this.bldgFilter=this.building.name,this.getFloors(this.building.hid)},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t}},mounted:function(){this.getBuildings()}},p=(r(90),r(3)),g=Object(p.a)(f,(function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",{staticClass:"content"},[t.loaded&&t.building?[r("div",{staticClass:"graph-header"},[r("div",{staticClass:"page-back"},[r("div",{staticClass:"back-button",on:{click:t.backTo}},[r("button",{staticClass:"btn btn-primary btn-small"},[r("caret-left-icon")],1),t._v("\n                    Back\n                ")])]),t._v(" "),r("div",{staticClass:"graph-filters"},[r("span",{staticClass:"graph-filter",on:{click:function(n){t.showFilter=!t.showFilter}}},[t._v("\n                    "+t._s(t.bldgFilter?t.bldgFilter:"Select Building")+"\n                    "),r("span",{staticClass:"caret"},[r("caret-icon")],1),t._v(" "),r("filter-dropdown",{attrs:{filters:t.buildingFilters,show:t.showFilter},on:{onSelect:t.filterSelect}})],1)]),t._v(" "),r("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(n){t.showPageOpts=!t.showPageOpts}}},[r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"})]),t._v(" "),r("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?r("div",{staticClass:"page-opt-panel"},[r("ul",[r("li",[r("a",{on:{click:function(n){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),r("div",{staticClass:"graph-content"},[r("div",{staticClass:"chart-header"},[r("span",{staticClass:"chart-title"},[t._v(t._s(t.building.name)+" Occupancy")])]),t._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col svg-wrapper"},[r("building-svg",{attrs:{floors:t.floors}})],1),t._v(" "),r("div",{staticClass:"col info-wrapper"},[r("table",[t._m(0),t._v(" "),r("tbody",t._l(t.floorsReverse,(function(n){return r("tr",{key:n.hid,staticClass:"floor-info"},[r("td",[t._v(t._s(n.ordinal_no+" Floor"))]),t._v(" "),r("td",[r("span",{staticClass:"occ-badge",class:t.getLiveColor(n.occupancy_live,n.occupancy_limit)},[t._v(t._s(n.occupancy_live))])]),t._v(" "),r("td",[r("span",{staticClass:"occ-badge orange"},[t._v(t._s(n.occupancy_limit))])])])})),0)])])])])]:t._e(),t._v(" "),r("loader",{attrs:{show:!t.loaded,type:"ripple"}})],2)}),[function(){var t=this.$createElement,n=this._self._c||t;return n("thead",[n("tr",{staticClass:"info-header"},[n("th",{attrs:{width:"100"}}),this._v(" "),n("th",{attrs:{width:"80"}},[this._v("Live")]),this._v(" "),n("th",{attrs:{width:"80"}},[this._v("Limit")])])])}],!1,null,"8475aa76",null);n.default=g.exports},33:function(t,n,r){"use strict";r.d(n,"a",(function(){return e}));var a=r(0);function e(t,n){var r=a.t(t),e=a.h(n),o=10,i=10,s=40,l=a.v().nodeSize([15,150]),c=a.l().x((function(t){return t.y})).y((function(t){return t.x})),d=r.append("svg").attr("viewBox",[-s,-o,900,15]).style("font-size","12px").style("user-select","none"),u=d.append("g").attr("fill","none").attr("stroke","#3DCFA3").attr("stroke-opacity",.4).attr("stroke-width",1.5),f=d.append("g").attr("cursor","pointer").attr("pointer-events","all");return e.x0=75,e.y0=0,e.descendants().forEach((function(t,n){t.id=n,t._children=t.children,t.depth&&7!==t.data.name.length&&(t.children=null)})),function t(n){var r=a.f&&a.f.altKey?2500:250,p=e.descendants().reverse(),g=e.links();l(e);var h=e,v=e;e.eachBefore((function(t){t.x<h.x&&(h=t),t.x>v.x&&(v=t)}));var b=v.x-h.x+o+i,_=d.transition().duration(r).attr("viewBox",[-s,h.x-o,900,b]).tween("resize",window.ResizeObserver?null:function(){return function(){return d.dispatch("toggle")}}),w=f.selectAll("g").data(p,(function(t){return t.id})),x=w.enter().append("g").attr("data-id",(function(t){return t.id})).attr("transform",(function(t){return"translate(".concat(n.y0,",").concat(n.x0,")")})).attr("fill-opacity",0).attr("stroke-opacity",0).on("click",(function(n){n.children=n.children?null:n._children,t(n)}));x.append("circle").attr("r",2.5).attr("fill",(function(t){return t._children,"#3DCFA3"})).attr("stroke-width",10),x.append("text").attr("dy","0.31em").attr("x",(function(t){return t._children?-6:6})).attr("text-anchor",(function(t){return t._children?"end":"start"})).attr("fill","#fff").text((function(t){return t.data.name})).clone(!0).lower().attr("stroke-linejoin","round").attr("stroke-width",3).attr("stroke","#2B2B2B"),w.merge(x).transition(_).attr("transform",(function(t){return"translate(".concat(t.y,",").concat(t.x,")")})).attr("fill-opacity",1).attr("stroke-opacity",1),w.exit().transition(_).remove().attr("transform",(function(t){return"translate(".concat(n.y,",").concat(n.x,")")})).attr("fill-opacity",0).attr("stroke-opacity",0);var m=u.selectAll("path").data(g,(function(t){return t.target.id})),y=m.enter().append("path").attr("d",(function(t){var r={x:n.x0,y:n.y0};return c([r,r])}));m.merge(y).transition(_).attr("d",(function(t){var n=t.target._children&&t.target._children.length>0,r=f.select('[data-id="'.concat(t.target.id,'"]')).node().getBBox(),a={x:t.target.x,y:t.target.y-r.width};return c(n?[t.source,a]:[t.source,t.target])})),m.exit().transition(_).remove().attr("d",(function(t){var r={x:n.x,y:n.y};return c([r,r])})),e.eachBefore((function(t){t.x0=t.x,t.y0=t.y}))}(e),d.node()}},90:function(t,n,r){"use strict";var a=r(18);r.n(a).a},91:function(t,n,r){(t.exports=r(7)(!1)).push([t.i,".svg-wrapper[data-v-8475aa76] {\n  text-align: right;\n}\n.svg-wrapper .building-svg[data-v-8475aa76] {\n  padding: 0 36px;\n}\n.info-wrapper[data-v-8475aa76] {\n  padding: 150px 36px 0;\n}\n.info-wrapper table[data-v-8475aa76] {\n  border-collapse: collapse;\n}\n.info-wrapper .info-header th[data-v-8475aa76] {\n  font-weight: normal;\n}\n.info-wrapper .floor-info[data-v-8475aa76] {\n  line-height: 26px;\n  border-bottom: 1px solid rgba(255, 255, 225, 0.1);\n}\n.info-wrapper .floor-info[data-v-8475aa76]:last-child {\n  border-bottom: none;\n}\n.info-wrapper .floor-info td[data-v-8475aa76] {\n  padding: 10px 0;\n}\n.info-wrapper .floor-info td[data-v-8475aa76]:first-child {\n  text-align: left;\n}\n.info-wrapper .floor-info .occ-badge[data-v-8475aa76] {\n  display: inline-block;\n  padding: 0 16px;\n  border-radius: 4px;\n}\n.info-wrapper .floor-info .occ-badge.green[data-v-8475aa76] {\n  background-color: #3DCFA3;\n}\n.info-wrapper .floor-info .occ-badge.yellow[data-v-8475aa76] {\n  background-color: #F0A718;\n}\n.info-wrapper .floor-info .occ-badge.orange[data-v-8475aa76] {\n  background-color: #FF5A09;\n}",""])}}]);