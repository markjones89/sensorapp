(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{17:function(t,n,e){var r=e(89);"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};e(8)(r,a);r.locals&&(t.exports=r.locals)},201:function(t,n,e){"use strict";e.r(n);var r=e(1),a=e.n(r),i=e(4),c=e(5),s=e(2),o=e(6),l=e(0);function u(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function f(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?u(Object(e),!0).forEach((function(n){h(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function h(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function p(t,n,e){var r=l.z(t),a=function t(n){if(n.value)return n;var e=n.children.map(t);return f(f({},n),{},{children:e,value:Math.floor(e.reduce((function(t,n){return t+n.value}),0)/e.length)})}(n),i=l.l(a).eachAfter((function(t){return t.index=t.parent?t.parent.index=t.parent.index+1||0:0})),c=l.y([!0,!1],["#FF5A09","#953100"]),s=30,o=30,u=0,h=200,p=150+s+u,d=g(i),v=l.x().domain([0,100]).range([h,950-o]);function g(t){return 30*t.children.length+s+u}function m(t,n,e,r){var a=e,i=e.children.reduce((function(t,n){return t+n.value}),0),c=t.insert("g",r).attr("class","enter").attr("transform","translate(0,".concat(s+3,")")).attr("text-anchor","end").style("font","10px sans-serif"),o=c.selectAll("g").data(e.children).join("g").attr("cursor",(function(t){return t.children?"pointer":null})).on("click",(function(e){return n(t,e)}));return o.append("text").attr("x",h-6).attr("y",13.5).attr("dy",".35em").attr("fill","currentColor").text((function(t){return t.data.name})),o.append("rect").attr("x",v(0)).attr("ry",13.5).attr("rx",13.5).attr("width",(function(t){return v(a.value*(t.value/i))-v(0)})).attr("height",27),c}function b(t,n,e){var r=0;return function(a){var i="translate(".concat(v(r/n*e)-v(0),",").concat(30*t,")");return r+=a.value,i}}function y(t,n){var e=0;return function(r,a){var i="translate(".concat(v(e/t*n)-v(0),",").concat(30*a,")");return e+=r.value,i}}function C(t,n){if(n.children&&!l.a(t.node())){t.select(".background").datum(n),x(n);var e=n.children.reduce((function(t,n){return t+n.value}),0),r=t.transition().duration(750),a=r.transition(),i=t.selectAll(".enter").attr("class","exit");i.selectAll("rect").attr("fill-opacity",(function(t){return t===n?0:null})),i.transition(r).attr("fill-opacity",0).remove();var s=m(t,C,n,".y-axis").attr("fill-opacity",0);s.transition(r).attr("fill-opacity",1),s.selectAll("g").attr("transform",b(n.index,e,n.value)).transition(r).attr("transform",y(e,n.value)),s.selectAll("g").transition(a).attr("transform",(function(t,n){return"translate(0,".concat(30*n,")")})),s.selectAll("rect").attr("fill",c(!0)).attr("fill-opacity",1).transition(a).attr("fill",(function(t){return c(!!t.children)})).attr("width",(function(t){return v(t.value)-v(0)}))}}var w=r.append("svg").attr("class","hierarchy-chart").attr("width",950).attr("height",d),k=w.append("rect").attr("class","background").attr("fill","none").attr("pointer-events","all").attr("width",950).attr("height",d).attr("cursor","pointer").on("click",(function(t){return function(t,n){if(n.parent&&t.selectAll(".exit").empty()){t.select(".background").datum(n.parent),x(n.parent);var r=n,a=n.children.reduce((function(t,n){return t+n.value}),0),i=t.transition().duration(750),s=i.transition(),o=t.selectAll(".enter").attr("class","exit");o.selectAll("g").transition(i).attr("transform",y(a,n.value)),o.selectAll("g").transition(s).attr("transform",b(n.index,a,n.value)),o.selectAll("rect").transition(i).attr("width",(function(t){return v(r.value*(t.value/a))-v(0)})).attr("fill",c(!0)),o.transition(s).attr("fill-opacity",0).remove();var u=m(t,C,n.parent,".exit").attr("fill-opacity",0);u.selectAll("g").attr("transform",(function(t,n){return"translate(0,".concat(30*n,")")})),u.transition(s).attr("fill-opacity",1),u.selectAll("rect").attr("fill",(function(t){return c(!!t.children)})).attr("fill-opacity",(function(t){return t===n?0:null})).transition(s).attr("width",(function(t){return v(t.value)-v(0)})).on("end",(function(t){l.z(this).attr("fill-opacity",1)}))}else e&&e.goBack&&e.goBack.call(this)}(w,t)}));function x(t){(d=g(t))<p&&(d=p),w.attr("height",d),w.select(".y-axis line").transition().duration(750).attr("y2",d-u),k.transition().duration(750).attr("height",d)}return w.append("g").call((function(t){return t.attr("class","x-axis").attr("transform","translate(0,".concat(s,")")).call(l.f(v).ticks(10).tickFormat((function(t){return"".concat(t,"%")}))).call((function(t){return(t.selection?t.selection():t).select(".domain").remove()}))})),w.append("g").call((function(t){return t.attr("class","y-axis").attr("transform","translate(".concat(h+.5,",0)")).call((function(t){return t.append("line").attr("stroke","currentColor").attr("y1",s).attr("y2",d-u)}))})),C(w,i),w.node()}function d(t,n,e,r,a,i,c){try{var s=t[i](c),o=s.value}catch(t){return void e(t)}s.done?n(o):Promise.resolve(o).then(r,a)}var v={title:"Peak Chart",components:{CaretIcon:o.a,Checkbox:s.a,DateRangeToggle:s.c,Modal:s.g,TimeSlider:s.h},data:function(){return{user:null,showPageOpts:!1,showEmbed:!1,timeFilter:{start:null,end:null}}},computed:{baseUrl:function(){return Object(c.c)()},settings:function(){return this.user.company?this.user.company.settings:null}},methods:{rangeSelect:function(t,n,e){console.log("rangeSelect",t,n,e)},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t},renderChart:function(){var t,n=this;return(t=a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch("".concat(n.baseUrl,"/data/detail-breakdown.json")).then((function(t){return t.json()})).then((function(t){p("#peak-chart",t,{goBack:function(){n.$router.back()}})}));case 1:case"end":return t.stop()}}),t)})),function(){var n=this,e=arguments;return new Promise((function(r,a){var i=t.apply(n,e);function c(t){d(i,r,a,c,s,"next",t)}function s(t){d(i,r,a,c,s,"throw",t)}c(void 0)}))})()},timeStartChange:function(t){this.timeFilter.start=t},timeEndChange:function(t){this.timeFilter.end=t},viewCostAnalysis:function(){this.$router.push({name:"cost-analysis"})},toLive:function(){this.$router.push({name:"occupancy"})}},created:function(){this.user=i.a.getUser()},mounted:function(){this.renderChart()}},g=(e(88),e(3)),m=Object(g.a)(v,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"content"},[e("div",{staticClass:"graph-header"},[e("date-range-toggle",{on:{select:t.rangeSelect}}),t._v(" "),e("div",{staticClass:"graph-filters"},[e("span",{staticClass:"graph-filter"},[t._v("\n                Select Location\n                "),e("span",{staticClass:"caret"},[e("caret-icon")],1)]),t._v(" "),e("a",{staticClass:"btn btn-primary ml-12",attrs:{href:"javascript:;"},on:{click:t.viewCostAnalysis}},[t._v("Cost Analysis")])]),t._v(" "),e("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(n){t.showPageOpts=!t.showPageOpts}}},[e("span",{staticClass:"dot"}),t._v(" "),e("span",{staticClass:"dot"}),t._v(" "),e("span",{staticClass:"dot"})]),t._v(" "),e("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?e("div",{staticClass:"page-opt-panel"},[e("ul",[e("li",[e("a",{on:{click:function(n){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),e("div",{staticClass:"graph-content"},[t._m(0),t._v(" "),e("div",{attrs:{id:"peak-chart"}}),t._v(" "),e("time-slider",{attrs:{from:t.settings?t.settings.start_time:null,to:t.settings?t.settings.end_time:null},on:{startChanged:t.timeStartChange,endChanged:t.timeEndChange}}),t._v(" "),e("div",{staticClass:"clearfix"})],1),t._v(" "),e("div",{staticClass:"graph-footer"},[e("div",{staticClass:"left-options"},[e("button",{staticClass:"btn btn-primary btn-small",on:{click:t.toLive}},[t._v("Live")]),t._v(" "),e("button",{staticClass:"btn btn-primary btn-small"},[t._v("Insights")])]),t._v(" "),e("div",{staticClass:"right-options"},[e("checkbox",{attrs:{label:"Save to report"}})],1)])])}),[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"chart-header"},[n("span",{staticClass:"chart-title"},[this._v("Building Name")]),this._v(" "),n("span",{staticClass:"chart-subtitle"},[this._v("Click the orange bar for more info or click the blank space to go back")])])}],!1,null,null,null);n.default=m.exports},88:function(t,n,e){"use strict";var r=e(17);e.n(r).a},89:function(t,n,e){(t.exports=e(7)(!1)).push([t.i,".hierarchy-chart {\n  pointer-events: initial;\n  transition: height 750ms;\n}",""])}}]);