(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{18:function(t,n,e){var r=e(89);"string"==typeof r&&(r=[[t.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};e(8)(r,a);r.locals&&(t.exports=r.locals)},201:function(t,n,e){"use strict";e.r(n);var r=e(1),a=e.n(r),i=e(4),c=e(5),s=e(2),o=e(6),l=e(0);function u(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function f(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?u(Object(e),!0).forEach((function(n){h(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function h(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function d(t,n,e){var r=l.z(t),a=Object(c.b)({},e).events,i=function t(n){if(n.value)return n;var e=n.children.map(t);return f(f({},n),{},{children:e,value:Math.floor(e.reduce((function(t,n){return t+n.value}),0)/e.length)})}(n),s=l.l(i).eachAfter((function(t){return t.index=t.parent?t.parent.index=t.parent.index+1||0:0})),o=l.y([!0,!1],["#FF5A09","#953100"]),u=30,h=30,d=0,p=215,v=150+u+d,g=b(s),m=l.x().domain([0,100]).range([p,950-h]);function b(t){return 30*t.children.length+u+d}function y(t,n,e,r){var a=e,i=e.children.reduce((function(t,n){return t+n.value}),0),c=t.insert("g",r).attr("class","enter").attr("transform","translate(0,".concat(u+3,")")).attr("text-anchor","end").style("font","10px sans-serif"),s=c.selectAll("g").data(e.children).join("g").attr("cursor",(function(t){return t.children||t.data.route?"pointer":null})).on("click",(function(e){return n(t,e)}));return s.append("text").attr("x",p-6).attr("y",13.5).attr("dy",".35em").attr("fill","currentColor").text((function(t){return t.data.name})),s.append("rect").attr("x",m(0)).attr("ry",13.5).attr("rx",13.5).attr("width",(function(t){return m(a.value*(t.value/i))-m(0)})).attr("height",27),c}function C(t,n,e){var r=0;return function(a){var i="translate(".concat(m(r/n*e)-m(0),",").concat(30*t,")");return r+=a.value,i}}function w(t,n){var e=0;return function(r,a){var i="translate(".concat(m(e/t*n)-m(0),",").concat(30*a,")");return e+=r.value,i}}function k(t,n){if(n.data.route)return a&&a.routeTo.call(n,n.data.route);if(n.children&&!l.a(t.node())){t.select(".background").datum(n),O(n);var e=n.children.reduce((function(t,n){return t+n.value}),0),r=t.transition().duration(750),i=r.transition(),c=t.selectAll(".enter").attr("class","exit");c.selectAll("rect").attr("fill-opacity",(function(t){return t===n?0:null})),c.transition(r).attr("fill-opacity",0).remove();var s=y(t,k,n,".y-axis").attr("fill-opacity",0);s.transition(r).attr("fill-opacity",1),s.selectAll("g").attr("transform",C(n.index,e,n.value)).transition(r).attr("transform",w(e,n.value)),s.selectAll("g").transition(i).attr("transform",(function(t,n){return"translate(0,".concat(30*n,")")})),s.selectAll("rect").attr("fill",o(!0)).attr("fill-opacity",1).transition(i).attr("fill",(function(t){return o(!!t.children)})).attr("width",(function(t){return m(t.value)-m(0)}))}}var x=r.append("svg").attr("class","hierarchy-chart").attr("width",950).attr("height",g),_=x.append("rect").attr("class","background").attr("fill","none").attr("pointer-events","all").attr("width",950).attr("height",g).attr("cursor","pointer").on("click",(function(t){return function(t,n){if(n.parent&&t.selectAll(".exit").empty()){t.select(".background").datum(n.parent),O(n.parent);var e=n,r=n.children.reduce((function(t,n){return t+n.value}),0),i=t.transition().duration(750),c=i.transition(),s=t.selectAll(".enter").attr("class","exit");s.selectAll("g").transition(i).attr("transform",w(r,n.value)),s.selectAll("g").transition(c).attr("transform",C(n.index,r,n.value)),s.selectAll("rect").transition(i).attr("width",(function(t){return m(e.value*(t.value/r))-m(0)})).attr("fill",o(!0)),s.transition(c).attr("fill-opacity",0).remove();var u=y(t,k,n.parent,".exit").attr("fill-opacity",0);u.selectAll("g").attr("transform",(function(t,n){return"translate(0,".concat(30*n,")")})),u.transition(c).attr("fill-opacity",1),u.selectAll("rect").attr("fill",(function(t){return o(!!t.children)})).attr("fill-opacity",(function(t){return t===n?0:null})).transition(c).attr("width",(function(t){return m(t.value)-m(0)})).on("end",(function(t){l.z(this).attr("fill-opacity",1)}))}else a&&a.goBack&&a.goBack.call(this)}(x,t)}));function O(t){(g=b(t))<v&&(g=v),x.attr("height",g),x.select(".y-axis line").transition().duration(750).attr("y2",g-d),_.transition().duration(750).attr("height",g)}return x.append("g").call((function(t){return t.attr("class","x-axis").attr("transform","translate(0,".concat(u,")")).call(l.f(m).ticks(10).tickFormat((function(t){return"".concat(t,"%")}))).call((function(t){return(t.selection?t.selection():t).select(".domain").remove()}))})),x.append("g").call((function(t){return t.attr("class","y-axis").attr("transform","translate(".concat(p+.5,",0)")).call((function(t){return t.append("line").attr("stroke","currentColor").attr("y1",u).attr("y2",g-d)}))})),k(x,s),x.node()}function p(t,n,e,r,a,i,c){try{var s=t[i](c),o=s.value}catch(t){return void e(t)}s.done?n(o):Promise.resolve(o).then(r,a)}var v={title:"Peak Chart",components:{CaretIcon:o.a,Checkbox:s.a,DateRangeToggle:s.c,Modal:s.g,TimeSlider:s.h},data:function(){return{user:null,showPageOpts:!1,showEmbed:!1,timeFilter:{start:null,end:null}}},computed:{baseUrl:function(){return Object(c.c)()},settings:function(){return this.user.company?this.user.company.settings:null}},methods:{rangeSelect:function(t,n,e){console.log("rangeSelect",t,n,e)},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t},renderChart:function(){var t,n=this;return(t=a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch("".concat(n.baseUrl,"/data/detail-breakdown.json")).then((function(t){return t.json()})).then((function(t){d("#peak-chart",t,{events:{goBack:function(){n.$router.back()},routeTo:function(t){n.$router.push({name:t})}}})}));case 1:case"end":return t.stop()}}),t)})),function(){var n=this,e=arguments;return new Promise((function(r,a){var i=t.apply(n,e);function c(t){p(i,r,a,c,s,"next",t)}function s(t){p(i,r,a,c,s,"throw",t)}c(void 0)}))})()},timeStartChange:function(t){this.timeFilter.start=t},timeEndChange:function(t){this.timeFilter.end=t},viewCostAnalysis:function(){this.$router.push({name:"cost-analysis"})},toLive:function(){this.$router.push({name:"occupancy"})}},created:function(){this.user=i.a.getUser()},mounted:function(){this.renderChart()}},g=(e(88),e(3)),m=Object(g.a)(v,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"content"},[e("div",{staticClass:"graph-header"},[e("date-range-toggle",{on:{select:t.rangeSelect}}),t._v(" "),e("div",{staticClass:"graph-filters"},[e("span",{staticClass:"graph-filter"},[t._v("\n                Select Location\n                "),e("span",{staticClass:"caret"},[e("caret-icon")],1)]),t._v(" "),e("a",{staticClass:"btn btn-primary ml-12",attrs:{href:"javascript:;"},on:{click:t.viewCostAnalysis}},[t._v("Cost Analysis")])]),t._v(" "),e("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(n){t.showPageOpts=!t.showPageOpts}}},[e("span",{staticClass:"dot"}),t._v(" "),e("span",{staticClass:"dot"}),t._v(" "),e("span",{staticClass:"dot"})]),t._v(" "),e("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?e("div",{staticClass:"page-opt-panel"},[e("ul",[e("li",[e("a",{on:{click:function(n){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),e("div",{staticClass:"graph-content"},[t._m(0),t._v(" "),e("div",{attrs:{id:"peak-chart"}}),t._v(" "),e("time-slider",{attrs:{from:t.settings?t.settings.start_time:null,to:t.settings?t.settings.end_time:null},on:{startChanged:t.timeStartChange,endChanged:t.timeEndChange}}),t._v(" "),e("div",{staticClass:"clearfix"})],1),t._v(" "),e("div",{staticClass:"graph-footer"},[e("div",{staticClass:"left-options"},[e("button",{staticClass:"btn btn-primary btn-small",on:{click:t.toLive}},[t._v("Live")]),t._v(" "),e("button",{staticClass:"btn btn-primary btn-small"},[t._v("Insights")])]),t._v(" "),e("div",{staticClass:"right-options"},[e("checkbox",{attrs:{label:"Save to report"}})],1)])])}),[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"chart-header"},[n("span",{staticClass:"chart-title"},[this._v("Building Name")]),this._v(" "),n("span",{staticClass:"chart-subtitle"},[this._v("Click the orange bar for more info or click the blank space to go back")])])}],!1,null,null,null);n.default=m.exports},88:function(t,n,e){"use strict";var r=e(18);e.n(r).a},89:function(t,n,e){(t.exports=e(7)(!1)).push([t.i,".hierarchy-chart {\n  pointer-events: initial;\n  transition: height 750ms;\n}",""])}}]);