(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{109:function(t,e,r){"use strict";r(43)},110:function(t,e,r){(t.exports=r(6)(!1)).push([t.i,"#tree-summary[data-v-38f8ed0c]{margin:24px auto;max-width:100%;width:1024px}",""])},286:function(t,e,r){"use strict";r.r(e);var a=r(1),n=r.n(a),i=r(5),s=r(0),o=r(4),c=r(8),l=r(11),u=r(2);function d(t,e,r){var a=u.y(t),n=u.l(e),i=u.k("$,.2s"),s=10,o=10,c=80,l=u.C().nodeSize([16,150]),d=u.o().x((function(t){return t.y})).y((function(t){return t.x})),h=a.append("svg").attr("viewBox",[-c,-s,900,16]).style("font-size","12px").style("user-select","none"),m=h.append("g").attr("fill","none").attr("stroke","#3DCFA3").attr("stroke-opacity",.4).attr("stroke-width",1.5),f=h.append("g").attr("cursor","pointer").attr("pointer-events","all");return n.x0=75,n.y0=0,n.descendants().forEach((function(t,e){t.id=e,t._children=t.children,t.depth&&7!==t.data.name.length&&(t.children=null)})),function t(e){var a=u.i&&u.i.altKey?2500:250,p=n.descendants().reverse(),g=n.links();l(n);var v=n,b=n;n.eachBefore((function(t){t.x<v.x&&(v=t),t.x>b.x&&(b=t)}));var _=b.x-v.x+s+o,y=h.transition().duration(a).attr("viewBox",[-c,v.x-s,900,_]).tween("resize",window.ResizeObserver?null:function(){return function(){return h.dispatch("toggle")}}),x=f.selectAll("g").data(p,(function(t){return t.id})),F=x.enter().append("g").attr("data-id",(function(t){return t.id})).attr("transform",(function(t){return"translate(".concat(e.y0,",").concat(e.x0,")")})).attr("fill-opacity",0).attr("stroke-opacity",0).on("click",(function(e){e.children=e.children?null:e._children,t(e)}));F.append("circle").attr("r",2.5).attr("fill",(function(t){return t._children,"#3DCFA3"})).attr("stroke-width",10),F.append("text").attr("dy","0.31em").attr("x",(function(t){return t._children?-6:6})).attr("text-anchor",(function(t){return t._children?"end":"start"})).attr("fill","#fff").text((function(t){return"".concat(t.data.name," ").concat(t.data.number?" - ".concat(t.data.value):r?i(t.data.value||0):"".concat(Math.round(t.data.value),"%"))})).clone(!0).lower().attr("stroke-linejoin","round").attr("stroke-width",3).attr("stroke","#2B2B2B"),x.merge(F).transition(y).attr("transform",(function(t){return"translate(".concat(t.y,",").concat(t.x,")")})).attr("fill-opacity",1).attr("stroke-opacity",1),x.exit().transition(y).remove().attr("transform",(function(t){return"translate(".concat(e.y,",").concat(e.x,")")})).attr("fill-opacity",0).attr("stroke-opacity",0);var w=m.selectAll("path").data(g,(function(t){return t.target.id})),O=w.enter().append("path").attr("d",(function(t){var r={x:e.x0,y:e.y0};return d({source:r,target:r})}));w.merge(O).transition(y).attr("d",(function(t){var e=t.target._children&&t.target._children.length>0,r=f.select('[data-id="'.concat(t.target.id,'"]')).node().getBBox(),a={x:t.target.x,y:t.target.y-r.width};return d(e?{source:t.source,target:a}:{source:t.source,target:t.target})})),w.exit().transition(y).remove().attr("d",(function(t){var r={x:e.x,y:e.y};return d({source:r,target:r})})),n.eachBefore((function(t){t.x0=t.x,t.y0=t.y}))}(n),h.node()}function h(t,e,r,a,n,i,s){try{var o=t[i](s),c=o.value}catch(t){return void r(t)}o.done?e(c):Promise.resolve(c).then(a,n)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function s(t){h(i,a,n,s,o,"next",t)}function o(t){h(i,a,n,s,o,"throw",t)}s(void 0)}))}}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var v={components:{CaretIcon:c.a,CaretLeftIcon:c.b,Checkbox:o.a,DateRangeToggle:o.c,FilterDropdown:o.d,Loader:o.f,TimeSlider:o.i,StatFilter:l.i},title:"Summary",data:function(){return{loaded:!1,showPageOpts:!1,showEmbed:!1,timeFilter:{start:null,end:null},minuteFilterLbl:"60 minutes",showMinuteFilter:!1,axiosSrc:null,dataError:null,dataFilters:{trigger:6,start_hour:8,stop_hour:16,start_date:"",stop_date:"",node_type:"Customer",node_id:"ad9b565d-9082-4808-99cd-32f2f09f63f2"}}},computed:p(p(p({},Object(i.d)({user:function(t){return t.user},company:function(t){return t.user.company},summary:function(t){return t.homepage.summary},filter:function(t){return t.homepage.filter},rangeFilter:function(t){return t.homepage.rangeFilter},startTimeFilter:function(t){return t.homepage.startTime},endTimeFilter:function(t){return t.homepage.endTime}})),Object(i.b)({api_header:"backend/api_header",api_customer_summary:"backend/api_customer_summary"})),{},{settings:function(){return this.user.company?this.user.company.settings:null},baseUrl:function(){return Object(s.g)()},minuteFilters:function(){return[60].map((function(t){return{value:t,label:"".concat(t," minutes")}}))},statDateRange:function(){var t=this.dataFilters.start_date,e=this.dataFilters.stop_date,r=new Date(t.substring(0,t.indexOf("T"))),a=new Date(e.substring(0,e.indexOf("T")));return Object(s.d)(r,a)}}),methods:p(p({},Object(i.c)({setSummary:"homepage/setSummary",setRange:"homepage/setRange",setTime:"homepage/setTime"})),{},{backTo:function(){this.$router.back()},rangeSelect:function(t,e,r){var a=Object(s.w)(e),n=Object(s.v)(r);this.setRange({type:t,start:a,end:n}),this.dataFilters.start_date=a,this.dataFilters.stop_date=n,this.axiosSrc&&this.axiosSrc.cancel("Date range selected"),Object(s.c)("#tree-summary"),this.renderTree(!0)},filterSelect:function(){Object(s.c)("#tree-summary"),this.renderTree()},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t},renderTree:function(){var t=arguments,e=this;return m(n.a.mark((function r(){var a,i,o,c,l,u,h,m,f,p;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=t.length>0&&void 0!==t[0]&&t[0],i=["building_country","building_city"],c={_:o=[]},l=e.filter.value,u="opportunity_cost"==l,e.loaded=!1,null!=e.summary&&!a){r.next=23;break}return e.axiosSrc=axios.CancelToken.source(),r.next=7,axios.post(e.api_customer_summary,e.dataFilters,e.api_header(e.axiosSrc.token));case 7:if(h=r.sent,(m=h.data).building_summary){r.next=15;break}return e.dataError=m,e.loaded=!0,r.abrupt("return");case 15:if(!m.building_summary||0!=m.building_summary.length){r.next=21;break}return e.dataError="No results",e.loaded=!0,r.abrupt("return");case 21:e.dataError=null,e.setSummary(m);case 23:f={ID:"",name:e.summary.customer,children:[]},p=JSON.parse(JSON.stringify(e.summary.building_summary)),f.value=(u?s.t:s.b)(p.map((function(t){return Object(s.k)(t,l,0)}))),p.forEach((function(t){t.name=t.building_name,t.value=Object(s.k)(t,l),t.children=[{name:"Free Desks at Peak",value:t.free_workspace_utils.max,number:!0},{name:"Free Meeting Rooms at Peak",value:t.free_meeting_room_occupancy.max,number:!0}],i.reduce((function(e,r){if(!e[t[r]]&&(e[t[r]]={_:[]},t[r])){var a,n=(g(a={},"name",t[r]),g(a,"children",e[t[r]]._),a);if("building_country"===r){var i=p.filter((function(e){return e[r]==t[r]}));n.value=(u?s.t:s.b)(i.map((function(t){return Object(s.k)(t,l)}))),n.building_country=!0}else if("building_city"===r){var o=p.filter((function(e){return e[r]==t[r]}));n.value=(u?s.t:s.b)(o.map((function(t){return Object(s.k)(t,l)}))),n.building_city=!0}e._.push(n)}return e[t[r]]}),c)._.push(t)})),f.children=o,e.loaded=!0,setTimeout((function(){d("#tree-summary",f,u)}),100);case 30:case"end":return r.stop()}}),r)})))()},timeStartChange:function(t,e){this.dataFilters.start_hour=e,this.setTime({start:e,end:this.dataFilters.stop_hour}),this.axiosSrc&&this.axiosSrc.cancel("Start time updated"),Object(s.c)("#tree-summary"),this.renderTree(!0)},timeEndChange:function(t,e){this.dataFilters.stop_hour=e,this.setTime({start:this.dataFilters.start_hour,end:e}),this.axiosSrc&&this.axiosSrc.cancel("End time updated"),Object(s.c)("#tree-summary"),this.renderTree(!0)},filterMinute:function(t){var e=this.minuteFilters.find((function(e){return e.value==t}));this.showMinuteFilter=!1,this.minuteFilterLbl=e.label}}),created:function(){if(this.company&&this.company.ref_id&&(this.dataFilters.node_id=this.company.ref_id),null==this.rangeFilter.type){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23),a=Object(s.w)(e),n=Object(s.v)(r);this.dataFilters.start_date=a,this.dataFilters.stop_date=n,this.setRange({type:"today",start:a,end:n})}else this.dataFilters.start_date=this.rangeFilter.start,this.dataFilters.stop_date=this.rangeFilter.end;this.startTimeFilter?(this.dataFilters.start_hour=this.timeFilter.start=this.startTimeFilter,this.dataFilters.stop_hour=this.timeFilter.end=this.endTimeFilter):this.settings&&(this.dataFilters.start_hour=this.timeFilter.start=Object(s.u)(this.settings.start_time),this.dataFilters.stop_hour=this.timeFilter.end=Object(s.u)(this.settings.end_time))},mounted:function(){this.renderTree()}},b=(r(109),r(3)),_=Object(b.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[r("div",{staticClass:"graph-header"},[r("div",{staticClass:"page-back"},[r("div",{staticClass:"back-button",on:{click:t.backTo}},[r("button",{staticClass:"btn btn-primary btn-small"},[r("caret-left-icon")],1),t._v("\n                Back\n            ")])]),t._v(" "),t.loaded?[t.loaded?r("div",{staticClass:"graph-filters"},[r("stat-filter",{on:{filterSelect:t.filterSelect}})],1):t._e(),t._v(" "),r("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(e){t.showPageOpts=!t.showPageOpts}}},[r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"})]),t._v(" "),r("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?r("div",{staticClass:"page-opt-panel"},[r("ul",[r("li",[r("a",{on:{click:function(e){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])]:t._e()],2),t._v(" "),r("div",{staticClass:"graph-content"},[r("div",{staticClass:"chart-header"},[r("span",{staticClass:"chart-title"},[t._v(t._s(t.filter.btnLabel))]),t._v(" "),r("span",{staticClass:"chart-subtitle"},[t._v(t._s(t.statDateRange))])]),t._v(" "),r("date-range-toggle",{attrs:{active:t.rangeFilter},on:{select:t.rangeSelect}}),t._v(" "),t.loaded?[t.dataError?r("div",{staticClass:"error-display",staticStyle:{height:"40vh"}},[r("p",[t._v(t._s(t.dataError))]),t._v(" "),r("a",{staticClass:"btn btn-primary",staticStyle:{"align-self":"center"},attrs:{href:"javascript:;"},on:{click:function(e){return t.renderTree(!0)}}},[t._v("Retry")])]):r("div",{attrs:{id:"tree-summary"}})]:r("div",{staticStyle:{height:"40vh"}},[r("loader",{attrs:{show:!t.loaded,type:"ripple"}})],1),t._v(" "),r("div",{staticClass:"bottom-filters"},[r("time-slider",{attrs:{from:t.timeFilter.start,to:t.timeFilter.end},on:{startChanged:t.timeStartChange,endChanged:t.timeEndChange}}),t._v(" "),r("span",{staticClass:"graph-filter",on:{click:function(e){t.showMinuteFilter=!t.showMinuteFilter}}},[t._v("\n                "+t._s(t.minuteFilterLbl?t.minuteFilterLbl:"Select")+"\n                "),r("span",{staticClass:"caret"},[r("caret-icon")],1),t._v(" "),r("filter-dropdown",{attrs:{filters:t.minuteFilters,position:"top",show:t.showMinuteFilter},on:{onSelect:t.filterMinute}})],1)],1)],2),t._v(" "),r("div",{staticClass:"graph-footer"},[r("div",{staticClass:"left-options"}),t._v(" "),r("div",{staticClass:"right-options"},[r("checkbox",{attrs:{label:"Save to report"}})],1)])])}),[],!1,null,"38f8ed0c",null);e.default=_.exports},43:function(t,e,r){var a=r(110);"string"==typeof a&&(a=[[t.i,a,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(7)(a,n);a.locals&&(t.exports=a.locals)}}]);