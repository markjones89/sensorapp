(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{124:function(t,e,a){"use strict";a(51)},125:function(t,e,a){(t.exports=a(6)(!1)).push([t.i,"#wfh-content[data-v-cd98b87c]{position:relative}#wfh-content .stat[data-v-cd98b87c]{position:absolute;font-weight:700;font-size:16px;text-align:center;min-width:48px;line-height:48px;border-radius:50%;bottom:16px;background-color:#ff5a09}#wfh-content #house-wrapper[data-v-cd98b87c]{position:relative;display:inline-block;padding:0 0 32px}#wfh-content #house-wrapper .house-svg[data-v-cd98b87c]{transform-origin:bottom;transition:transform .4s}#wfh-content #house-wrapper .stat[data-v-cd98b87c]{margin-left:90px}#wfh-content #building-wrapper[data-v-cd98b87c]{position:relative;display:inline-block;padding:0 0 32px}#wfh-content #building-wrapper .building-svg[data-v-cd98b87c]{transform-origin:bottom;transition:transform .4s}#wfh-content #building-wrapper .stat[data-v-cd98b87c]{margin-left:120px}",""])},296:function(t,e,a){"use strict";a.r(e);var i=a(1),r=a.n(i),n=a(5),s=a(8),o=a(4),c=a(21),l=a(0);function u(t,e,a,i,r,n,s){try{var o=t[n](s),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(i,r)}function d(t){return function(){var e=this,a=arguments;return new Promise((function(i,r){var n=t.apply(e,a);function s(t){u(n,i,r,s,o,"next",t)}function o(t){u(n,i,r,s,o,"throw",t)}s(void 0)}))}}function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){m(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function m(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var f={title:"Work From Home",components:{BuildingSvg:c.a,CaretIcon:s.a,CaretLeftIcon:s.b,Checkbox:o.a,DateRangeToggle:o.c,GraphFilter:o.e,HouseSvg:c.b,Loader:o.f,TimeSlider:o.i},data:function(){return{loaded:!1,showPageOpts:!1,showEmbed:!1,locations:[],floors:[{id:1,number:1,occupancy_live:0,occupancy_limit:100},{id:2,number:2,occupancy_live:0,occupancy_limit:100},{id:3,number:3,occupancy_live:0,occupancy_limit:100},{id:4,number:4,occupancy_live:0,occupancy_limit:100}],building:null,wfhStat:0,bldgStat:0,timeFilter:{start:null,end:null},minuteFilter:60,dataError:null,axiosSrc:null,dataFilters:{trigger:6,start_hour:8,stop_hour:16,low_desk_filter:.2,start_date:"",stop_date:"",node_type:"Customer",node_id:"ad9b565d-9082-4808-99cd-32f2f09f63f2"}}},computed:p(p(p({},Object(n.d)({user:function(t){return t.user},company:function(t){return t.user.company},summary:function(t){return t.homepage.summary},filter:function(t){return t.homepage.filter},rangeFilter:function(t){return t.homepage.rangeFilter},locationFilter:function(t){return t.homepage.locationFilter},startTimeFilter:function(t){return t.homepage.startTime},endTimeFilter:function(t){return t.homepage.endTime}})),Object(n.b)({api_header:"backend/api_header",api_customers:"backend/api_customers",api_customer_summary:"backend/api_customer_summary"})),{},{settings:function(){return this.user.company?this.user.company.settings:null},homeScale:function(){return(this.wfhStat<25?25:this.wfhStat)/100},bldgScale:function(){return(this.bldgStat<25?25:this.bldgStat)/100},minuteFilters:function(){return[60].map((function(t){return{value:t,label:"".concat(t," minutes")}}))},selectedLocation:function(){var t;return null===(t=this.locationFilter)||void 0===t?void 0:t.value},locationLabel:function(){var t;return null===(t=this.locationFilter)||void 0===t?void 0:t.label},statDateRange:function(){var t=this.dataFilters.start_date,e=this.dataFilters.stop_date,a=new Date(t.substring(0,t.indexOf("T"))),i=new Date(e.substring(0,e.indexOf("T")));return Object(l.d)(a,i)}}),methods:p(p({},Object(n.c)({setSummary:"homepage/setSummary",setRange:"homepage/setRange",setLocation:"homepage/setLocation"})),{},{backTo:function(){this.$router.back()},getStats:function(){var t=this.locationFilter;if(t){var e=this.summary.building_summary;if(t.building){var a=e.find((function(e){return e.building_id==t.value}));this.wfhStat=Math.round(Object(l.k)(a,"work_from_home.average_percentage",0))}else{var i=[];i=t.city?e.filter((function(e){return"".concat(e.building_country,"_").concat(e.building_city,"_City").replace(/\s/g,"")==t.value})):t.country?e.filter((function(e){return e.building_country.replace(/\s/g,"")==t.value})):e,this.wfhStat=Math.round(Object(l.b)(i.map((function(t){return Object(l.k)(t,"work_from_home.average_percentage",0)}))))}this.bldgStat=100-this.wfhStat}},getData:function(){var t=arguments,e=this;return d(r.a.mark((function a(){var i,n,s,o,c,u;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t.length>0&&void 0!==t[0]&&t[0],e.loaded=!1,n=null==e.summary||i,a.prev=3,!n){a.next=17;break}return e.axiosSrc=axios.CancelToken.source(),a.next=8,axios.post(e.api_customer_summary,e.dataFilters,e.api_header(e.axiosSrc.token));case 8:if(s=a.sent,!(o=s.data).building_summary||0!=o.building_summary.length){a.next=16;break}return e.dataError="No results",e.loaded=!0,a.abrupt("return");case 16:e.setSummary(o);case 17:c=JSON.parse(JSON.stringify(e.summary)),e.loaded=!0,e.dataError=null,u=Object(l.f)(c),null==e.locationFilter&&e.setLocation({label:c.customer,value:c.customer}),e.locations=u,e.getStats(),a.next=31;break;case 26:a.prev=26,a.t0=a.catch(3),console.error("getData.error",a.t0),e.dataError="Unable to retrieve data, please try again",e.loaded=!0;case 31:case"end":return a.stop()}}),a,null,[[3,26]])})))()},filterSelect:function(t,e,a){this.setLocation(a),this.getStats()},toTreeSummary:function(){this.$router.push({name:"tree-summary",query:{df:this.filter.value}})},rangeSelect:function(t,e,a){var i=Object(l.y)(e),r=Object(l.x)(a);this.loaded=!1,this.setRange({type:t,start:i,end:r}),this.dataFilters.start_date=i,this.dataFilters.stop_date=r,this.axiosSrc&&this.axiosSrc.cancel("Filters changed"),this.getData(!0)},timeStartChange:function(t,e){this.loaded=!1,this.dataFilters.start_hour=e,this.setTime({start:e,end:this.dataFilters.stop_hour}),this.axiosSrc&&this.axiosSrc.cancel("Filters changed"),this.getData(!0)},timeEndChange:function(t,e){this.loaded=!1,this.dataFilters.stop_hour=e,this.setTime({start:this.dataFilters.start_hour,end:e}),this.axiosSrc&&this.axiosSrc.cancel("Filters changed"),this.getData(!0)},filterMinute:function(t){this.minuteFilter=t},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t}}),created:function(){if(this.company&&this.company.ref_id&&(this.dataFilters.node_id=this.company.ref_id),null==this.rangeFilter.type){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23),i=Object(l.y)(e),r=Object(l.x)(a);this.dataFilters.start_date=i,this.dataFilters.stop_date=r,this.setRange({type:"today",start:i,end:r})}else this.dataFilters.start_date=this.rangeFilter.start,this.dataFilters.stop_date=this.rangeFilter.end;this.startTimeFilter?(this.dataFilters.start_hour=this.timeFilter.start=this.startTimeFilter,this.dataFilters.stop_hour=this.timeFilter.end=this.endTimeFilter):this.settings&&(this.dataFilters.start_hour=this.timeFilter.start=Object(l.w)(this.settings.start_time),this.dataFilters.stop_hour=this.timeFilter.end=Object(l.w)(this.settings.end_time))},mounted:function(){this.getData()}},g=(a(124),a(3)),b=Object(g.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("div",{staticClass:"graph-header"},[a("date-range-toggle",{attrs:{active:t.rangeFilter},on:{select:t.rangeSelect}}),t._v(" "),t.loaded?a("div",{staticClass:"graph-filters"},[a("graph-filter",{attrs:{placeholder:"Select Location",filters:t.locations,chosen:t.selectedLocation,chosenAsSelected:!0},on:{onSelect:t.filterSelect}}),t._v(" "),a("a",{staticClass:"btn btn-primary ml-12",attrs:{href:"javascript:;"},on:{click:t.toTreeSummary}},[t._v(t._s(t.filter.btnLabel))])],1):t._e(),t._v(" "),a("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(e){t.showPageOpts=!t.showPageOpts}}},[a("span",{staticClass:"dot"}),t._v(" "),a("span",{staticClass:"dot"}),t._v(" "),a("span",{staticClass:"dot"})]),t._v(" "),a("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?a("div",{staticClass:"page-opt-panel"},[a("ul",[a("li",[a("a",{on:{click:function(e){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),a("div",{staticClass:"graph-content"},[a("div",{staticClass:"page-back"},[a("div",{staticClass:"back-button",on:{click:t.backTo}},[a("button",{staticClass:"btn btn-primary btn-small"},[a("caret-left-icon")],1),t._v("\n                Back\n            ")])]),t._v(" "),t.loaded?[t.dataError?a("div",{staticClass:"error-display",staticStyle:{height:"60vh"}},[a("p",[t._v(t._s(t.dataError))]),t._v(" "),a("a",{staticClass:"btn btn-primary",staticStyle:{"align-self":"center"},attrs:{href:"javascript:;"},on:{click:function(e){return t.getData(!0)}}},[t._v("Retry")])]):[a("div",{staticClass:"chart-header"},[a("span",{staticClass:"chart-title"},[t._v(t._s("Work From Home - "+t.locationLabel))]),t._v(" "),a("span",{staticClass:"chart-subtitle"},[t._v("("+t._s(t.statDateRange)+")")])]),t._v(" "),a("div",{attrs:{id:"wfh-content"}},[a("div",{attrs:{id:"house-wrapper"}},[a("house-svg",{style:{transform:"scale("+t.homeScale+")"}}),t._v(" "),a("span",{staticClass:"stat"},[t._v(t._s(t.wfhStat+"%"))])],1),t._v(" "),a("div",{attrs:{id:"building-wrapper"}},[a("building-svg",{style:{transform:"scale("+t.bldgScale+")"},attrs:{floors:t.floors}}),t._v(" "),a("span",{staticClass:"stat"},[t._v(t._s(t.bldgStat+"%"))])],1)])]]:a("div",{staticStyle:{height:"60vh"}},[a("loader",{attrs:{show:!t.loaded,type:"ripple"}})],1),t._v(" "),a("div",{staticClass:"bottom-filters"},[a("time-slider",{attrs:{from:t.timeFilter.start,to:t.timeFilter.end},on:{startChanged:t.timeStartChange,endChanged:t.timeEndChange}}),t._v(" "),a("graph-filter",{attrs:{filters:t.minuteFilters,chosen:t.minuteFilter,chosenAsSelected:!0,position:"top"},on:{onSelect:t.filterMinute}})],1)],2),t._v(" "),a("div",{staticClass:"graph-footer"},[a("div",{staticClass:"left-options"}),t._v(" "),a("div",{staticClass:"right-options"},[a("checkbox",{attrs:{label:"Save to report"}})],1)])])}),[],!1,null,"cd98b87c",null);e.default=b.exports},51:function(t,e,a){var i=a(125);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a(7)(i,r);i.locals&&(t.exports=i.locals)}}]);