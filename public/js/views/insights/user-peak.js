(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{184:function(t,e,r){var n=r(256);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(8)(n,a);n.locals&&(t.exports=n.locals)},255:function(t,e,r){"use strict";r(184)},256:function(t,e,r){(t.exports=r(7)(!1)).push([t.i,"#area-filter[data-v-18a1d4e0]{display:flex;justify-content:left;align-items:center}",""])},425:function(t,e,r){"use strict";r.r(e);var n=r(1),a=r.n(n),i=r(6),l=r(9),s=r(5),o=r(2);var c=function(t,e,r){var n,a,i,l=o.y(t),s=10,c=30,u=30,d=50,f=800-d-c,p=400-s-u,h=l.append("svg").attr("width",f+d+c).attr("height",p+s+u).append("g").attr("transform","translate("+d+","+s+")");e.length,e.push({label:"",xValue:(null!==(n=o.q(e,(function(t){return t.xValue})))&&void 0!==n?n:0)+1,yValue:null!==(a=null===(i=e[e.length-1])||void 0===i?void 0:i.yValue)&&void 0!==a?a:0}),console.log("create.data",e);var g=C(e),b=o.w().domain(o.j(e,(function(t){return t.xValue}))).range([0,f]),m=o.q(e,(function(t){return t.yValue})),v=-m,y=o.w().domain([v,m]).range([p,0]),_=h.append("linearGradient").attr("id","area-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",y(0)).attr("x2",f).attr("y2",y(0)).selectAll("stop").data([{offset:"0%",color:"#524FFF"},{offset:"100%",color:"#FF5A09"}]).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})),w=h.append("g").attr("class","grid").attr("transform","translate(0,"+p+")").style("opacity",.1),x=h.append("path").datum(e).attr("fill","url(#area-gradient)").attr("d",o.c().x((function(t){return b(t.xValue)})).y0(p/2).y1(p/2)),F=h.append("path").datum(g).attr("fill","url(#area-gradient)").attr("d",o.c().x((function(t){return b(t.xValue)})).y0(p/2).y1(p/2)),k=h.append("g").attr("class","labels").attr("transform","translate(0,0)");function C(t){var e=[];return t.forEach((function(t){e.push({label:t.label,xValue:t.xValue,yValue:-t.yValue})})),e}return this.update=function(t,e){var r,n,a;e&&t.push({label:"",xValue:(null!==(r=o.q(t,(function(t){return t.xValue})))&&void 0!==r?r:0)+1,yValue:null!==(n=null===(a=t[t.length-1])||void 0===a?void 0:a.yValue)&&void 0!==n?n:0}),console.log("update.data",t);var i=t.length,l=o.q(t,(function(t){return t.yValue})),s=-l,c=C(t),u=o.w().domain(o.j(t,(function(t){return t.xValue}))).range([0,f]),d=o.w().domain([s,l]).range([p,0]);_.attr("x1",0).attr("y1",d(0)).attr("x2",f).attr("y2",d(0)),w.selectAll(".tick").remove(),w.call(o.d(u).ticks(i).tickSize(-p).tickFormat("")).call((function(t){t.select(".domain").remove(),t.selectAll(".tick text").remove()})),x.datum(t).transition().duration(750).attr("d",o.c().x((function(t){return u(t.xValue)})).y0(d(0)).y1((function(t){return d(t.yValue)}))),F.datum(c).transition().duration(750).attr("d",o.c().x((function(t){return u(t.xValue)})).y0(d(0)).y1((function(t){return d(t.yValue)}))),k.selectAll(".tick").remove(),k.call(o.d(u).ticks(i).tickSize(0).tickFormat((function(e,r){if(r===i)return"";var n=t.find((function(t){return t.xValue===e}));return n?n.yValue:""}))).call((function(e){e.select(".domain").remove(),e.select(".tick:last-child").remove(),e.selectAll(".tick").each((function(e,r){var n=o.y(this),a=t.find((function(t){return t.xValue===e}));a&&(n.select("text").attr("font-size",16).attr("text-anchor","start").attr("x",10).attr("class","value"),n.append("text").attr("font-size",10).attr("text-anchor","start").attr("x",10).attr("y",24).attr("dy","0.71em").attr("fill","currentColor").attr("class","label").text(a.label))}))}))},this.update(e),this},u=r(0);function d(t,e,r,n,a,i,l){try{var s=t[i](l),o=s.value}catch(t){return void r(t)}s.done?e(o):Promise.resolve(o).then(n,a)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function l(t){d(i,n,a,l,s,"next",t)}function s(t){d(i,n,a,l,s,"throw",t)}l(void 0)}))}}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b=[];function m(){return Math.floor(600*Math.random()+1)}var v={title:"User Peak",components:{CaretIcon:l.a,CaretLeftIcon:l.b,Checkbox:s.a,DateRangeToggle:s.c,FilterDropdown:s.d,Loader:s.f,TimeSlider:s.i},data:function(){return{loaded:!1,showPageOpts:!1,showEmbed:!1,buildings:[],building:null,areas:["All Areas","Department","Informal Meeting Spaces","Meeting Rooms","Workspace Desk Area"],showFilter:!1,showAreaFilter:!1,chart:null,bldgFilter:null,areaFilter:"All Areas",timeFilter:{start:null,end:null},minuteFilter:"10 minutes",showMinuteFilter:!1}},computed:h(h(h({},Object(i.d)({user:function(t){return t.user.info},filter:function(t){return t.homepage.filter}})),Object(i.b)({api_header:"backend/api_header",api_customers:"backend/api_customers",api_buildings:"backend/api_buildings",api_floors:"backend/api_floors"})),{},{settings:function(){return this.user.company?this.user.company.settings:null},buildingFilters:function(){return this.buildings.map((function(t){return{value:t.id,label:t.name}}))},minuteFilters:function(){return[10,15,30,45,60,120,240,480].map((function(t){return{value:t,label:"".concat(t," minutes")}}))}}),methods:{backTo:function(){this.$router.back()},getBuildings:function(){var t=this;return f(a.a.mark((function e(){var r,n,i,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.user.company_id,e.next=3,axios.get(t.api_buildings(r),t.api_header());case 3:return n=e.sent,i=n.data,t.buildings=i,t.bldg_id?t.building=i.find((function(e){return e.id===t.bldg_id})):t.building=i[0],t.bldgFilter=t.building.name,e.next=10,t.getFloors(t.building.id);case 10:l=e.sent,t.loaded=!0,b=l,setTimeout((function(){t.renderChart(l.slice(0))}),0);case 14:case"end":return e.stop()}}),e)})))()},getFloors:function(t){var e=this;return f(a.a.mark((function r(){var n,i,l,s;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.user.company_id,r.next=3,axios.get(e.api_floors(n,t),e.api_header());case 3:return i=r.sent,(l=i.data).forEach((function(t){return t.ordinal_no=Object(u.y)(t.number)})),s=l.sort((function(t,e){return t.number>e.number?1:t.number<e.number?-1:0})),e.floors=s.slice(0),r.abrupt("return",s.map((function(t){return{label:"".concat(t.ordinal_no," Floor"),xValue:t.number,yValue:m()}})));case 9:case"end":return r.stop()}}),r)})))()},filterSelect:function(t,e){var r=this;return f(a.a.mark((function n(){var i,l,s;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=r.building.id,r.showFilter=!1,r.building=r.buildings.find((function(e){return e.id===t})),r.bldgFilter=e,i!=t){n.next=9;break}l=b.slice(0).map((function(t){return{label:t.label,xValue:t.xValue,yValue:m()}})),r.chart.update(l,!0),n.next=14;break;case 9:return n.next=11,r.getFloors(r.building.id);case 11:s=n.sent,b=s,r.chart.update(s.slice(0),!0);case 14:case"end":return n.stop()}}),n)})))()},toTreeSummary:function(){this.$router.push({name:"tree-summary",query:{df:this.filter.value}})},rangeSelect:function(t,e,r){},toLive:function(){this.$router.push({name:"occupancy",query:{bid:this.building.id}})},timeStartChange:function(t){this.timeFilter.start=t},timeEndChange:function(t){this.timeFilter.end=t},filterMinute:function(t){var e=this.minuteFilters.find((function(e){return e.value==t}));this.showMinuteFilter=!1,this.minuteFilter=e.label},renderChart:function(t){this.chart=new c("#user-peak-chart",t)},filterByArea:function(t,e){this.showAreaFilter=!1,this.areaFilter=e;var r=b.slice(0).map((function(t){return{label:t.label,xValue:t.xValue,yValue:m()}}));this.chart.update(r,!0)},toggleEmbed:function(t){t&&(this.showPageOpts=!1),this.showEmbed=t}},mounted:function(){this.getBuildings()}},y=(r(255),r(4)),_=Object(y.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t.loaded&&t.building?[r("div",{staticClass:"graph-header"},[r("date-range-toggle",{on:{select:t.rangeSelect}}),t._v(" "),r("div",{staticClass:"graph-filters"},[r("span",{staticClass:"graph-filter",on:{click:function(e){t.showFilter=!t.showFilter}}},[t._v("\n                    "+t._s(t.bldgFilter?t.bldgFilter:"Select Building")+"\n                    "),r("span",{staticClass:"caret"},[r("caret-icon")],1),t._v(" "),r("filter-dropdown",{attrs:{filters:t.buildingFilters,show:t.showFilter},on:{onSelect:t.filterSelect}})],1),t._v(" "),r("a",{staticClass:"btn btn-primary ml-12",attrs:{href:"javascript:;"},on:{click:t.toTreeSummary}},[t._v(t._s(t.filter.btnLabel))])]),t._v(" "),r("span",{staticClass:"page-opt-trigger",attrs:{role:"button"},on:{click:function(e){t.showPageOpts=!t.showPageOpts}}},[r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"}),t._v(" "),r("span",{staticClass:"dot"})]),t._v(" "),r("transition",{attrs:{name:"fadeUp"}},[t.showPageOpts?r("div",{staticClass:"page-opt-panel"},[r("ul",[r("li",[r("a",{on:{click:function(e){return t.toggleEmbed(!0)}}},[t._v("Embed")])])])]):t._e()])],1),t._v(" "),r("div",{staticClass:"graph-content"},[r("div",{staticClass:"page-back"},[r("div",{staticClass:"back-button",on:{click:t.backTo}},[r("button",{staticClass:"btn btn-primary btn-small"},[r("caret-left-icon")],1),t._v("\n                    Back\n                ")])]),t._v(" "),r("div",{staticClass:"chart-header"},[r("span",{staticClass:"chart-title"},[t._v(t._s(t.building.name+" User Peak"))]),t._v(" "),t.areaFilter?r("span",{staticClass:"chart-subtitle"},[t._v(t._s("("+t.areaFilter+")"))]):t._e()]),t._v(" "),r("div",{staticClass:"row"},[t._m(0),t._v(" "),r("div",{staticClass:"col-12 col-md-3",attrs:{id:"area-filter"}},[r("span",{staticClass:"graph-filter",on:{click:function(e){t.showAreaFilter=!t.showAreaFilter}}},[t._v("\n                        "+t._s(t.areaFilter?t.areaFilter:"Select Area")+"\n                        "),r("span",{staticClass:"caret"},[r("caret-icon")],1),t._v(" "),r("filter-dropdown",{attrs:{filters:t.areas,show:t.showAreaFilter},on:{onSelect:t.filterByArea}})],1)])]),t._v(" "),r("div",{staticClass:"bottom-filters"},[r("time-slider",{attrs:{from:t.settings?t.settings.start_time:null,to:t.settings?t.settings.end_time:null},on:{startChanged:t.timeStartChange,endChanged:t.timeEndChange}}),t._v(" "),r("span",{staticClass:"graph-filter",on:{click:function(e){t.showMinuteFilter=!t.showMinuteFilter}}},[t._v("\n                    "+t._s(t.minuteFilter?t.minuteFilter:"Select")+"\n                    "),r("span",{staticClass:"caret"},[r("caret-icon")],1),t._v(" "),r("filter-dropdown",{attrs:{filters:t.minuteFilters,position:"top",show:t.showMinuteFilter},on:{onSelect:t.filterMinute}})],1)],1)]),t._v(" "),r("div",{staticClass:"graph-footer"},[r("div",{staticClass:"left-options"},[r("button",{staticClass:"btn btn-primary btn-small",on:{click:t.toLive}},[t._v("Live")])]),t._v(" "),r("div",{staticClass:"right-options"},[r("checkbox",{attrs:{label:"Save to report"}})],1)])]:t._e(),t._v(" "),r("loader",{attrs:{show:!t.loaded,type:"ripple"}})],2)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col"},[e("div",{attrs:{id:"user-peak-chart"}})])}],!1,null,"18a1d4e0",null);e.default=_.exports}}]);